// RTK Queryã¯ã€Redux Toolkitã®ä¸€éƒ¨ã§ã€APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’åŠ¹ç‡çš„ã«è¡Œã†ãŸã‚ã®ãƒ„ãƒ¼ãƒ«
import { createApi, fetchBaseQuery } from '@reduxjs/toolkit/query/react'

// TipsğŸ’¡
// ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã¯1ã¤ã®createApiå‘¼ã³å‡ºã—ã—ã‹ãªã„ã“ã¨ãŒæœŸå¾…ã•ã‚Œã‚‹ã€‚
// ã“ã®1ã¤ã®APIã‚¹ãƒ©ã‚¤ã‚¹ã¯ã€åŒã˜ãƒ™ãƒ¼ã‚¹URLã¨ä¼šè©±ã™ã‚‹ã™ã¹ã¦ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®šç¾©ã‚’å«ã‚€ã¹ã
// ä¾‹ï¼‰ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ/api/postsã¨/api/usersã¯ã©ã¡ã‚‰ã‚‚åŒã˜ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ•ã‚§ãƒƒãƒã™ã‚‹ã®ã§ã€åŒã˜APIã‚¹ãƒ©ã‚¤ã‚¹ã«å…¥ã‚‹

// createApi: å˜ä¸€ã®APIã‚¹ãƒ©ã‚¤ã‚¹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å®šç¾©
//    APIã«é–¢é€£ã™ã‚‹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¨ãƒªãƒ‡ãƒ¥ãƒ¼ã‚µãƒ¼ã‚’è‡ªå‹•çš„ã«ç”Ÿæˆ
//    ã“ã®é–¢æ•°ã«ã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ¸¡ã™ã€‚ä»¥ä¸‹ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒå«ã¾ã‚Œã‚‹ï¼š
//        reducerPath: ç”Ÿæˆã•ã‚ŒãŸAPIã‚¹ãƒ©ã‚¤ã‚¹ãŒReduxã‚¹ãƒˆã‚¢ã®ã©ã®éƒ¨åˆ†ã«è¿½åŠ ã•ã‚Œã‚‹ã¹ãã‹ã‚’ç¤ºã™ã€‚ã“ã®ä¾‹ã§ã¯ã€'api'ã¨ã„ã†ãƒ‘ã‚¹ã‚’æŒ‡å®š
//        baseQuery: APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã®åŸºæœ¬ã¨ãªã‚‹ã‚¯ã‚¨ãƒªã‚’å®šç¾©
//        endpoints: APIã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼ˆã¤ã¾ã‚Šã€APIã®ç‰¹å®šã®æ“ä½œã‚„ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼‰ã‚’å®šç¾©ã€‚'/posts'ã¨ã„ã†URLã«å¯¾ã™ã‚‹ã‚¯ã‚¨ãƒªãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¡¨ã™

// ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒªãƒ‡ãƒ¥ãƒ¼ã‚µãƒ¼ï¼š
//    APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã®çµæœã‚’ä¸€æ™‚çš„ã«ä¿å­˜ï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼‰ã™ã‚‹ãŸã‚ã®Reduxã®ãƒªãƒ‡ãƒ¥ãƒ¼ã‚µãƒ¼
//    ãƒªãƒ‡ãƒ¥ãƒ¼ã‚µãƒ¼ã¯ã€Reduxã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã«å¿œã˜ã¦ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®çŠ¶æ…‹ã‚’æ›´æ–°ã™ã‚‹é–¢æ•°
//    ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒªãƒ‡ãƒ¥ãƒ¼ã‚µãƒ¼ã¯ç‰¹ã«APIã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ‡ãƒ¼ã‚¿ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¨ã—ã¦ç®¡ç†
//    ä¸»ãªç›®çš„ï¼šåŒã˜APIãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒç¹°ã‚Šè¿”ã—è¡Œã‚ã‚Œã‚‹å ´åˆã«ã€æ—¢ã«å–å¾—æ¸ˆã¿ã®ãƒ‡ãƒ¼ã‚¿ã‚’å†åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’å‘ä¸Šã•ã›ã‚‹
export const apiSlice = createApi({
  // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒªãƒ‡ãƒ¥ãƒ¼ã‚µãƒ¼ã¯ state.api ã«è¿½åŠ ã•ã‚Œã‚‹ã“ã¨ã‚’æœŸå¾…ï¼ˆã™ã§ã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ - ã“ã‚Œã¯ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«ï¼‰
  reducerPath: 'api',
  // ã™ã¹ã¦ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ '/fakeApi' ã‹ã‚‰å§‹ã¾ã‚‹URLã‚’æŒã¤
  baseQuery: fetchBaseQuery({ baseUrl: '/fakeApi' }),
  // ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¯ã€é€šå¸¸ã€ç‰¹å®šã®ãƒªã‚½ãƒ¼ã‚¹ã‚’è¡¨ã™åå‰ã¨ã€ãã®ãƒªã‚½ãƒ¼ã‚¹ã«å¯¾ã™ã‚‹æ“ä½œï¼ˆGETã€POSTã€PUTã€DELETEãªã©ï¼‰ã‚’çµ„ã¿åˆã‚ã›ãŸã‚‚ã®
  // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€GET HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ä½¿ç”¨
  // { urlï¼š'/posts', method: 'POST', body: newPost } ã®ã‚ˆã†ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”ã™ã“ã¨ã§ä¸Šæ›¸ãå¯èƒ½
  endpoints: (builder) => ({
    // getPostsã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¯ãƒ‡ãƒ¼ã‚¿ã‚’è¿”ã™"ã‚¯ã‚¨ãƒª"æ“ä½œ
    getPosts: builder.query({
      // ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®URLã¯ '/fakeApi/posts'
      query: () => '/posts',
    }),
    getPost: builder.query({
      // æ³¨æ„â—ï¸: ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å˜ä¸€ã®å€¤ã§ãªã‘ã‚Œã°ãªã‚‰ãªã„
      // è¤‡æ•°ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ¸¡ã™å¿…è¦ãŒã‚ã‚‹å ´åˆã¯ã€è¤‡æ•°ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’å«ã‚€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ¸¡ã™å¿…è¦ãŒã‚ã‚‹ï¼ˆcreateAsyncThunkã¨å…¨ãåŒã˜)
      query: (postId) => `/posts/${postId}`,
    }),
    //  builder.mutation(): å¤‰ç•°ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®è¿½åŠ 
    addNewPost: builder.mutation({
      query: (initialPost) => ({
        url: '/posts',
        method: 'POST',
        body: initialPost,
      }),
    }),
  }),
})

// getPostsã‚¯ã‚¨ãƒªã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸãƒ•ãƒƒã‚¯ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
// createApié–¢æ•°ã«ã‚ˆã£ã¦è‡ªå‹•çš„ã«ç”Ÿæˆã•ã‚Œã‚‹
export const { useGetPostsQuery, useGetPostQuery } = apiSlice
